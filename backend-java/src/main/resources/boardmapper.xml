<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.wfl.mbtest.board.dto.BoardMapper">
   <!-- 게시판 -->
      <!-- 게시글 목록-->
   <select id="list" resultType="Board">
      SELECT *
      FROM board
      ORDER BY reg_date DESC
   </select>
   
   <!-- 게시글 조회 -->
   <select id="select" resultType="Board">
      SELECT *
      FROM board
      WHERE no = #{no}
   </select>
   
   <!-- 게시글 등록-->
   <insert id="insert">
      INSERT INTO board ( title, userNickname, content )
      VALUES ( #{title}, #{userNickname}, #{content} )
   </insert>
   
   <!-- 게시글 수정-->
   <update id="update">
      UPDATE board
         SET title = #{title},
            userNickname = #{userNickname},
            content = #{content},
            upd_date = TO_CHAR(CURRENT_TIMESTAMP, 'yyyy-MM-dd HH:MM:SS') 
      WHERE no = #{no}      
   </update>
   
   <!-- 게시글 삭제-->
   <delete id = "delete">
      DELETE FROM board
      WHERE no = #{no}
   </delete>
   
   <!-- 조회수 업데이트-->
   <update id ="updateViews">
      UPDATE board
         SET view = views + #{count}
      WHERE no = #{no}   
   </update>
   
      <!-- 게시판 검색-->
   <select id="searchBoard" parameterType="HashMap" resultType="Board">
      SELECT * FROM board <choose>
         <when test="value ==null">
         </when>
         <when test="category == 'title'">
            WHERE title LIKE '%'||#{value}||'%'
         </when>
         <when test="category == 'content'">
            WHERE content LIKE '%'||#{value}||'%'
         </when>
         <when test="category == 'userNickname'">
            WHERE userNickname LIKE '%'||#{value}||'%'
         </when>
      </choose>
   </select>
   
</mapper>